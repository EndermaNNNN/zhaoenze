# PHP2 

## 解题思路：

- 拿到网站，网站说要身份验证，完全不知道它在说什么

- 尝试../index.php  ../robots.txt  ../config.php ，审查元素，以及伪造 XFF 和 Referer，均无效果

- 上网查，知道了要用 `.phps` 看源代码，我寻思这谁能想到？正常服务器谁会给你查看源代码的权限？

- 不过好歹的算是拿到源代码了，贴在下面：

    ```php
    "); exit(); 
    } 
    $_GET[id] = urldecode($_GET[id]); 
    if($_GET[id] == "admin") 
    { echo "
    ```

- 这段代码很简单，就是把拿到的get参数再进行url解码一遍，意思是原来的是它收到的时候这个字符串就应该是加密过的。

- 这意味着：
    - 在发送时先编码一遍-->网页自动解码一遍-->是原文，服务器拒绝访问

    - 在发送时编码两遍-->网页自动解码一遍-->是编码过的，服务器开始解码

    所以发送前要编码两遍。

- 直接在网上找编码工具，发现字母无论编码几遍都还是字母，感觉到事情有点不对劲，用这个方法传参，果然不行，服务器返回 `not allowed` 。

- 那就把字母也替换成url编码，编两遍，这次成功了：

    `id=%2561%2564%256d%2569%256e`

- 那么为什么不行呢？我尝试构造其他串：

    `id=%2561dmin` 

    这个串是可以获取flag的，那么应该是在第一次解码的时候会检查get的内容，如果是裸输admin，会被过滤掉。

    `id=%61dmin` 

    这个串则不行，因为网页第一次解码时就已经把%61给还原成a了，而这样会导致串被服务器过滤掉。

## 学到的东西：

- .phps文件：用来给没有直接打开.php文件源码的用户查看源码的文件，话说这种文件除了在这种场合之外，真的还能在其他生产环境里面运用吗？什么样的服务器php代码是专门用来给用户看的？为什们这些代码不单独写成文档的形式呢？