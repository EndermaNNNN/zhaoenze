# Cephalopod

## 解题思路：

- 首先看题，题目说：

    **我们发现一些奇怪的网络流量，我们怀疑它包含一个flag。**

- 下载附件，发现是一个.pcap文件，那不必多说，先拿wireshark打开看看。

- 打开后发现是一堆流量记录，有TCP和Ceph两种流量报文,猜测可能是分布式存储系统给客户传东西，对每个报文进行一下追踪TCP流：

    - 当 `tcp.stream == 0` 时，没什么有用信息，只能看到一些 ceph 的基本信息，包括ceph的版本号，osdmap的相关函数调用等。

    - 当 `tcp.stream == 1` 时，除相关ceph信息和乱码外，还发现tcp流里面有 `flag.png` 字样，有可能传输了图片类型的flag，但是整个流的大小只有 7 kb，应该不是这个流传输的，再接着往下看。

    - 当 `tcp.stream == 2` 时，发现这个TCP流居然长达 2413kb ，猜测它有很大可能就是图片传输的载体，想办法把它读出来。

- 利用wireshark自带的 `Save as ...` 尝试将整个流以.png的形式保存下来，但不出意外地，保存下来的png图片无法读取。看了网上资料，说 **wireshark只能支持在报文中明确含有JPEG信息字段的图片报文的读取** ，看来得另想办法了。

- 在网上找了找，发现 tcpxtract 可以对图片流进行还原，于是在自己的虚拟机上安了 tcpxtract，输入指令：

    ```
    sudo apt-get install tcpxtract

    tcpxtract -f 434c8c0ba659476caa9635b97f95600c.pcap
    ```

    tcpxtract直接就把图片转存下来了，打开图片，flag就在图片上写着，我没想到怎么从图片上取字符，于是直接拿手输了一遍，完成。